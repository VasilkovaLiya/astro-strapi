---
import BaseLayout from '../../layouts/BaseLayout.astro';

const API_URL = import.meta.env.STRAPI_URL || 'http://localhost:1337';
let spark = null;

try {
  const response = await fetch(`${API_URL}/api/sparks/random`);
  if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
  
  const result = await response.json();
  spark = result.data; // Обратите внимание на .data
  
  // Для отладки
  console.log('Fetched spark:', spark);
} catch (error) {
  console.error('Fetch error:', error);
}
---



<BaseLayout>
   <div class="container">
    <h1>Случайный генератор вдохновения</h1>
    {spark ? (
        <div class="spark">
          {spark.type === 'quote' && (
            <blockquote>
              "{spark.text}"
              {spark.author && <footer>— {spark.author}</footer>}
            </blockquote>
          )}
          
          <!-- Кнопка для нового запроса -->
          <a href="/inspiration/random-quote" class="refresh-button">Get Another</a>
        </div>
      ) : (
        <p>Error loading content. Please try again.</p>
      )}
      
      <style>
        .spark {
          max-width: 600px;
          margin: 2rem auto;
          padding: 1.5rem;
          border-radius: 8px;
          background: #f8f9fa;
        }
        blockquote {
          font-size: 1.5rem;
          font-style: italic;
          margin: 0 0 1rem 0;
        }
        footer {
          display: block;
          margin-top: 1rem;
          font-weight: bold;
        }
        .refresh-button {
          display: inline-block;
          margin-top: 1rem;
          padding: 0.5rem 1rem;
          background: #0070f3;
          color: white;
          border-radius: 4px;
          text-decoration: none;
        }
      </style>
</BaseLayout>